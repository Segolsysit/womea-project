<!DOCTYPE html>
<html lang="en">
<!-- kkkkkk -->

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="admin.css">
    <link rel="icon" type="image/png" href="assets/img/logo/top1.png" sizes="60*60">

    <style>
        .tab {
            margin-top: 10%;
            text-align: center;
            z-index: 2;
            position: relative;
        }

        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }

        td,
        th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;

        }

        th {
            background-color: #673ab7;
            color: white;
            text-align: center;

        }

        /* tr:nth-child(even) {
            background-color: #dddddd;
        } */

        #table-container {
            position: relative;
            top: 0px;
        }
    </style>
    <script src="jquery-3.6.4.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-app.js"> </script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-database-compat.js"> </script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-auth.js"></script>
    <!-- <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-functions.js"></script> -->
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-app.js"> </script>
    <script src="https://www.gstatic.com/firebasejs/9.19.0/firebase-database-compat.js"> </script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js"></script>
</head>

<body>
    <!-- <label>Name</label><br />
    <input id="advname" placeholder="enter your Name"><br /><br />
    <label>Email</label><br />
    <input id="advemail" placeholder="enter your email"><br /><br />
    <label>Password</label><br />
    <input id="advpassword" placeholder="enter your Passwords"><br /><br />
    <select id="course">
        <option value="course 1">course 1</option>
        <option value="course 2">course 2</option>
        <option value="course 3">course 3</option>
        <option value="course 4">course 4</option>
    </select><br /><br />
    <label>number</label><br />
    <input id="number"><br /><br />
    <button onclick="signup()">register</button> -->


    <!-- <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
        x="0px" y="0px" width="800px" height="600px" viewBox="0 0 800 600" enable-background="new 0 0 800 600"
        xml:space="preserve">
        <linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="174.7899" y1="186.34" x2="330.1259" y2="186.34"
            gradientTransform="matrix(0.8538 0.5206 -0.5206 0.8538 147.9521 -79.1468)">
            <stop offset="0" style="stop-color:#FFC035" />
            <stop offset="0.221" style="stop-color:#F9A639" />
            <stop offset="1" style="stop-color:#E64F48" />
        </linearGradient>
        <circle fill="url(#SVGID_1_)" cx="266.498" cy="211.378" r="77.668" />
        <linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="290.551" y1="282.9592" x2="485.449"
            y2="282.9592">
            <stop offset="0" style="stop-color:#FFA33A" />
            <stop offset="0.0992" style="stop-color:#E4A544" />
            <stop offset="0.9624" style="stop-color:#00B59C" />
        </linearGradient>
        <circle fill="url(#SVGID_2_)" cx="388" cy="282.959" r="97.449" />
        <linearGradient id="SVGID_3_" gradientUnits="userSpaceOnUse" x1="180.3469" y1="362.2723" x2="249.7487"
            y2="362.2723">
            <stop offset="0" style="stop-color:#12B3D6" />
            <stop offset="1" style="stop-color:#7853A8" />
        </linearGradient>
        <circle fill="url(#SVGID_3_)" cx="215.048" cy="362.272" r="34.701" />
        <linearGradient id="SVGID_4_" gradientUnits="userSpaceOnUse" x1="367.3469" y1="375.3673" x2="596.9388"
            y2="375.3673">
            <stop offset="0" style="stop-color:#12B3D6" />
            <stop offset="1" style="stop-color:#7853A8" />
        </linearGradient>
        <circle fill="url(#SVGID_4_)" cx="482.143" cy="375.367" r="114.796" />
        <linearGradient id="SVGID_5_" gradientUnits="userSpaceOnUse" x1="365.4405" y1="172.8044" x2="492.4478"
            y2="172.8044" gradientTransform="matrix(0.8954 0.4453 -0.4453 0.8954 127.9825 -160.7537)">
            <stop offset="0" style="stop-color:#FFA33A" />
            <stop offset="1" style="stop-color:#DF3D8E" />
        </linearGradient>
        <circle fill="url(#SVGID_5_)" cx="435.095" cy="184.986" r="63.504" />
    </svg> -->

    <div style="display: flex; flex-direction: column; align-items: center;">
        <button class="signout" onclick="Signout()" style="cursor: pointer;">SignOut</button>

        <div class="container">
            <h2>Register</h2>
            <form id="form">
                <input type="text" id="advname" class="name" placeholder="name">
                <br />
                <input type="text" id="advemail" class="email" placeholder="email">
                <br />
                <input type="text" id="advpassword" class="pwd" placeholder="password">
                <br />
                <input type="text" id="number" class="number" placeholder="number">
                <br />
                <select id="course" class="number">
                    <option value="Tailoring Course ">Tailoring Course </option>
                    <option value="Aari Work Course(Tamil)">Aari Work Course(Tamil)</option>
                    <option value="NailArt Course">NailArt Course</option>
                    <option value="Saree Drapping Course">Saree Drapping Course </option>
                    <option value="Mehandi Course"> Mehandi Course</option>
                    <option value="Hairstyle Course">Hairstyle Course</option>
                    <option value="Flower Making Course">Flower Making Course</option>
                    <option value="Beautician Course">Beautician Course</option>
                    <option value="Baking Course">Baking Course</option>
                    <option value="Makeup Course">Makeup Course</option>
                    <option value="Aari Work Course(Malayalam)">Aari Work Course(Malayalam)</option>
                    <option value="Aari Work Course(telugu)">Aari Work Course(telugu)</option>






                </select>
            </form>
            <br /><br />
            <button class="register" onclick="signup()">
                <span>register</span>
            </button>
            <!-- <button class="signin">
    <span>sign in</span>
  </button> -->
            <h3>your registration is complete ! </h3>
            <h3>your sign in is complete !</h3>
            <div class="reg"></div>
            <div class="sig"></div>



        </div>
        <br>


        <h1
            style="margin: 2px; background-color:whitesmoke;  width: fit-content; text-align: center; padding: 10px; border-radius: 5px;font-family:'Times New Roman', Times, serif; color: rgb(103, 87, 87);">
            Course Registered Users
            List</h1>
        <div style="width: 100%; overflow-x: scroll; text-align: center;">
            <br>
            <table id="dynamic-table" style="position: relative;background-color: white; text-align: center; ">
                <thead>
                    <tr>
                        <th>S.No</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Password</th>
                        <th>Course</th>
                        <th>Number</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Table rows will be dynamically added here -->
                </tbody>
            </table>
        </div>
    </div>

    </div>

    <!-- <div id="table-container"></div> -->

    <script>


        function Signout() {
            localStorage.removeItem('isLoggedIn');
            window.location = 'admin-login.html'
        }


        window.onload = window.scrollTo({
            left: 0,
            top: 0,
            behavior: "smooth" // Optional, adds smooth scrolling animation
        });
        // window.screenTop()
        let currentUser;
        function getusername() {
            // const user = firebase.auth().currentUser;
            // if (user !== null) {
            //     const username = user.Username;
            // }

            currentUser = localStorage.getItem("isLoggedIn");
        }

        window.onload = function () {
            getusername();
            // let AdminToken = 

            if (currentUser === null) {
                window.location = "admin-login.html"
            }
        }
        const firebaseApp = firebase.initializeApp({
            apiKey: "AIzaSyC_17NSBZj7055hemtCvXbt6iAnpefJEjk",
            authDomain: "womea-ae77f.firebaseapp.com",
            databaseURL: "https://womea-ae77f-default-rtdb.firebaseio.com",
            projectId: "womea-ae77f",
            storageBucket: "womea-ae77f.appspot.com",
            messagingSenderId: "614719223379",
            appId: "1:614719223379:web:4d0252a711236c066b78a6"
        });

        const auth = firebaseApp.auth();


        const ref = [
            { course: "Tailoring Course" },
            { course: "Aari Work Course(Tamil)" },
            { course: "NailArt Course" },
            { course: "Saree Drapping Course" },
            { course: "Mehandi Course" },
            { course: "Hairstyle Course" },
            { course: "Flower Making Course" },
            { course: "Beautician Course" },
            { course: "Baking Course" },
            { course: "Makeup Course" },
            { course: "Aari Work Course(Malayalam)" },
            { course: "Aari Work Course(telugu)" },



        ]
        var i = 1;

        for (const iterator of ref) {
            const arr = [];
            const structure = [];
            var usersRef = firebase.database().ref(iterator.course);

            // usersRef = firebase.database().ref("course 3");

            console.log(usersRef);
            usersRef.once('value')
                .then(snapshot => {
                    var data = snapshot.val();
                    snapshot.forEach(childSnap => {
                        arr.push(childSnap.key);

                    });
                    console.log(data); // Data retrieved from the 'users' location
                    console.log(arr);


                    function print() {
                        for (let i = 0; i < arr.length; i++) {
                            const datas = {
                                email: data[arr[i]].email,
                                course: data[arr[i]].course,
                                name: data[arr[i]].name,
                                number: data[arr[i]].number,
                                password: data[arr[i]].password
                            }
                            structure.push(datas);
                            console.log(structure);
                            console.log(data[arr[i]].email);
                        }
                    }
                    print();

                    function populateTable(str) {
                        const tableBody = document.querySelector("#dynamic-table tbody");
                        console.log(str);

                        str.forEach(item => {
                            const row = document.createElement("tr");
                            row.innerHTML = `
            <td>${i++}</td>
            <td>${item.name}</td>
            <td>${item.email}</td>
            <td>${item.password}</td>
            <td>${item.course}</td>
            <td>${item.number}</td>

        `;
                            tableBody.appendChild(row);
                        });
                    }

                    window.load = populateTable(structure);

                    // console.log(print);
                    // console.log(data[arr[0]].email);

                })
                .catch(error => {
                    console.error('Error retrieving data:', error);
                });
            // console.log();

        }

        function signup() {
            // e.preventDefault()
            let name = document.getElementById('advname').value;
            let email = document.getElementById('advemail').value.toLowerCase();
            let password = document.getElementById('advpassword').value;
            let course = document.getElementById('course').value;
            let number = document.getElementById('number').value;
            var firebaseRef = firebase.database().ref(`${course}`)
            var coursevalue = {
                name: name,
                email: email,
                password: password,
                number: number,
                course: course
            }

            console.log(email, password);
            firebase.auth().createUserWithEmailAndPassword(email, password)
                .then(function () {
                    // Signed in 
                    console.log(course);
                    firebaseRef.push(coursevalue);
                    let res = document.getElementById("form");
                    res.reset();
                    alert("register successful!")
                    window.location = "admin.html"
                    this.siblings('.reg').css({
                        'transform': 'translateY(40%) scale(5)',
                        'border-radius': '0',
                        'width': '100%',
                        'height': '100%'
                    }).end();


                    reg_btn.siblings('.container h3:nth-of-type(1)').css({
                        'top': '40%',
                        'z-index': '8',
                    }).end().end();

                })
                .catch((error) => {
                    console.log(error.code);
                    console.log(error.message);
                    // ..
                });


        }

        // const dynamicData = [
        //     // { name: "John Doe", age: 25, country: "USA" },
        //     // { name: "Jane Smith", age: 30, country: "Canada" },
        //     // Add more data as needed
        // ];

        // Function to create and populate the table


        // Call the function to populate the table when the page loads
        // setTimeout(() => {

        // }, 4000);

    </script>
    <!-- <script src="admin.js"></script> -->
</body>

</html>